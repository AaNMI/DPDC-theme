{"version":3,"file":"email-campaign.js","sources":["email-campaign.js"],"sourcesContent":["$(function () {\n  var to = encodeURIComponent($('#campaign-email-to').text()) || '',\n    bcc = encodeURIComponent($('#campaign-email-bcc').text()) || '',\n    subject = encodeURIComponent($('#campaign-email-subject').text()) || '',\n    body = encodeURIComponent($('#campaign-email-body').text()) || '',\n    next = $('#campaign-next').text() || '/',\n    head = 'mailto:' + to + '?subject=' + subject + '&bcc=' + bcc,\n    full = head + '&body=' + body,\n    gmail =\n      'https://mail.google.com/mail/u/0/?view=cm&source=mailto' +\n      '&to=' +\n      to +\n      '&bcc=' +\n      bcc +\n      '&su=' +\n      subject,\n    yahoo =\n      'http://compose.mail.yahoo.com/' +\n      '?To=' +\n      to +\n      '&Subject=' +\n      subject +\n      '&Bcc=' +\n      bcc,\n    canOpenFull =\n      /Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera\\sMini/i.test(\n        navigator.userAgent\n      ) && !/IEMobile/i.test(navigator.userAgent),\n    started = false,\n    copied = false,\n    container = $('.campaign-email-panel');\n\n  function render() {\n    container.empty();\n    if (!started) {\n      if (canOpenFull) {\n        container.append([$('<button>').html('Send email').click(open(full))]);\n      } else {\n        container.append([$('<button>').html('Start').click(copy)]);\n      }\n    } else {\n      if (!copied) {\n        container.append(\n          $('<p>').html(\n            'Copy the email below, open your mail app, ' + 'paste and send!'\n          )\n        );\n      } else {\n        container.append(\n          $('<p>').html(\n            '<b>Copied the email!</b> Now open ' +\n              'your mail app, paste and send!'\n          )\n        );\n      }\n      container.append([\n        $('<button>').html('Gmail').click(open(gmail)),\n        ' ',\n        $('<button>').html('Yahoo').click(open(yahoo)),\n        ' ',\n        $('<button>').html('System Email App').click(open(head)),\n      ]);\n    }\n\n    container.append([\n      ' ',\n      $('<a>').html('View email').attr('href', '#').click(manual),\n    ]);\n\n    if (started && !copied) manual();\n  }\n\n  $('.campaign-email-manual').hide();\n\n  function open(url) {\n    return function (event) {\n      window.open(url);\n      location.href = next;\n      event.preventDefault();\n    };\n  }\n\n  function copy() {\n    started = true;\n    select($('#campaign-email-body')[0]);\n    copied = document.execCommand('copy');\n    render();\n  }\n\n  function manual() {\n    $('.campaign-email-manual').show();\n  }\n\n  function select(text) {\n    var range, selection;\n    if (document.body.createTextRange) {\n      range = document.body.createTextRange();\n      range.moveToElementText(text);\n      range.select();\n    } else if (window.getSelection) {\n      range = document.createRange();\n      range.selectNodeContents(text);\n      selection = window.getSelection();\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n\n  $('.campaign-email-field').click(function (e) {\n    select(e.target);\n  });\n\n  render();\n});\n"],"names":["$","to","encodeURIComponent","text","bcc","subject","body","next","head","full","gmail","yahoo","canOpenFull","test","navigator","userAgent","started","copied","container","render","empty","append","html","click","open","copy","attr","manual","url","event","window","location","href","preventDefault","select","document","execCommand","show","range","createTextRange","moveToElementText","getSelection","createRange","selectNodeContents","selection","removeAllRanges","addRange","hide","e","target"],"mappings":"AAAAA,EAAE,WACA,IAAIC,EAAKC,mBAAmBF,EAAE,sBAAsBG,SAAW,GAC7DC,EAAMF,mBAAmBF,EAAE,uBAAuBG,SAAW,GAC7DE,EAAUH,mBAAmBF,EAAE,2BAA2BG,SAAW,GACrEG,EAAOJ,mBAAmBF,EAAE,wBAAwBG,SAAW,GAC/DI,EAAOP,EAAE,kBAAkBG,QAAU,IACrCK,EAAO,UAAYP,EAAK,YAAcI,EAAU,QAAUD,EAC1DK,EAAOD,EAAO,SAAWF,EACzBI,EACE,8DAEAT,EACA,QACAG,EACA,OACAC,EACFM,EACE,qCAEAV,EACA,YACAI,EACA,QACAD,EACFQ,EACE,yDAAyDC,KACvDC,UAAUC,aACN,YAAYF,KAAKC,UAAUC,WACnCC,GAAU,EACVC,GAAS,EACTC,EAAYlB,EAAE,yBAEhB,SAASmB,IACPD,EAAUE,QACLJ,GAOEC,EAOHC,EAAUG,OACRrB,EAAE,OAAOsB,KACP,qEARJJ,EAAUG,OACRrB,EAAE,OAAOsB,KACP,8DAWNJ,EAAUG,OAAO,CACfrB,EAAE,YAAYsB,KAAK,SAASC,MAAMC,EAAKd,IACvC,IACAV,EAAE,YAAYsB,KAAK,SAASC,MAAMC,EAAKb,IACvC,IACAX,EAAE,YAAYsB,KAAK,oBAAoBC,MAAMC,EAAKhB,OAzBhDI,EACFM,EAAUG,OAAO,CAACrB,EAAE,YAAYsB,KAAK,cAAcC,MAAMC,EAAKf,MAE9DS,EAAUG,OAAO,CAACrB,EAAE,YAAYsB,KAAK,SAASC,MAAME,KA0BxDP,EAAUG,OAAO,CACf,IACArB,EAAE,OAAOsB,KAAK,cAAcI,KAAK,OAAQ,KAAKH,MAAMI,KAGlDX,IAAYC,GAAQU,IAK1B,SAASH,EAAKI,GACZ,OAAO,SAAUC,GACfC,OAAON,KAAKI,GACZG,SAASC,KAAOzB,EAChBsB,EAAMI,kBAIV,SAASR,IACPT,GAAU,EACVkB,EAAOlC,EAAE,wBAAwB,IACjCiB,EAASkB,SAASC,YAAY,QAC9BjB,IAGF,SAASQ,IACP3B,EAAE,0BAA0BqC,OAG9B,SAASH,EAAO/B,GACd,IAAImC,EACAH,SAAS7B,KAAKiC,kBAChBD,EAAQH,SAAS7B,KAAKiC,mBAChBC,kBAAkBrC,GACxBmC,EAAMJ,UACGJ,OAAOW,gBAChBH,EAAQH,SAASO,eACXC,mBAAmBxC,IACzByC,EAAYd,OAAOW,gBACTI,kBACVD,EAAUE,SAASR,IAhCvBtC,EAAE,0BAA0B+C,OAoC5B/C,EAAE,yBAAyBuB,MAAM,SAAUyB,GACzCd,EAAOc,EAAEC,UAGX9B","sourceRoot":"/source/"}