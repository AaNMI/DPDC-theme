{"version":3,"file":"email-campaign.js","sources":["email-campaign.js"],"sourcesContent":["$(function () {\r\n  var to = encodeURIComponent($('#campaign-email-to').text()) || '',\r\n    bcc = encodeURIComponent($('#campaign-email-bcc').text()) || '',\r\n    subject = encodeURIComponent($('#campaign-email-subject').text()) || '',\r\n    body = encodeURIComponent($('#campaign-email-body').text()) || '',\r\n    next = $('#campaign-next').text() || '/',\r\n    head = 'mailto:' + to + '?subject=' + subject + '&bcc=' + bcc,\r\n    full = head + '&body=' + body,\r\n    gmail =\r\n      'https://mail.google.com/mail/u/0/?view=cm&source=mailto' +\r\n      '&to=' +\r\n      to +\r\n      '&bcc=' +\r\n      bcc +\r\n      '&su=' +\r\n      subject,\r\n    yahoo =\r\n      'http://compose.mail.yahoo.com/' +\r\n      '?To=' +\r\n      to +\r\n      '&Subject=' +\r\n      subject +\r\n      '&Bcc=' +\r\n      bcc,\r\n    canOpenFull =\r\n      /Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera\\sMini/i.test(\r\n        navigator.userAgent\r\n      ) && !/IEMobile/i.test(navigator.userAgent),\r\n    started = false,\r\n    copied = false,\r\n    container = $('.campaign-email-panel');\r\n\r\n  function render() {\r\n    container.empty();\r\n    if (!started) {\r\n      if (canOpenFull) {\r\n        container.append([$('<button>').html('Send email').click(open(full))]);\r\n      } else {\r\n        container.append([$('<button>').html('Start').click(copy)]);\r\n      }\r\n    } else {\r\n      if (!copied) {\r\n        container.append(\r\n          $('<p>').html(\r\n            'Copy the email below, open your mail app, ' + 'paste and send!'\r\n          )\r\n        );\r\n      } else {\r\n        container.append(\r\n          $('<p>').html(\r\n            '<b>Copied the email!</b> Now open ' +\r\n              'your mail app, paste and send!'\r\n          )\r\n        );\r\n      }\r\n      container.append([\r\n        $('<button>').html('Gmail').click(open(gmail)),\r\n        ' ',\r\n        $('<button>').html('Yahoo').click(open(yahoo)),\r\n        ' ',\r\n        $('<button>').html('System Email App').click(open(head)),\r\n      ]);\r\n    }\r\n\r\n    container.append([\r\n      ' ',\r\n      $('<a>').html('View email').attr('href', '#').click(manual),\r\n    ]);\r\n\r\n    if (started && !copied) manual();\r\n  }\r\n\r\n  $('.campaign-email-manual').hide();\r\n\r\n  function open(url) {\r\n    return function (event) {\r\n      window.open(url);\r\n      location.href = next;\r\n      event.preventDefault();\r\n    };\r\n  }\r\n\r\n  function copy() {\r\n    started = true;\r\n    select($('#campaign-email-body')[0]);\r\n    copied = document.execCommand('copy');\r\n    render();\r\n  }\r\n\r\n  function manual() {\r\n    $('.campaign-email-manual').show();\r\n  }\r\n\r\n  function select(text) {\r\n    var range, selection;\r\n    if (document.body.createTextRange) {\r\n      range = document.body.createTextRange();\r\n      range.moveToElementText(text);\r\n      range.select();\r\n    } else if (window.getSelection) {\r\n      range = document.createRange();\r\n      range.selectNodeContents(text);\r\n      selection = window.getSelection();\r\n      selection.removeAllRanges();\r\n      selection.addRange(range);\r\n    }\r\n  }\r\n\r\n  $('.campaign-email-field').click(function (e) {\r\n    select(e.target);\r\n  });\r\n\r\n  render();\r\n});\r\n"],"names":["$","to","encodeURIComponent","text","bcc","subject","body","next","head","full","gmail","yahoo","canOpenFull","test","navigator","userAgent","started","copied","container","render","empty","append","html","click","open","copy","attr","manual","url","event","window","location","href","preventDefault","select","document","execCommand","show","range","createTextRange","moveToElementText","getSelection","createRange","selectNodeContents","selection","removeAllRanges","addRange","hide","e","target"],"mappings":"AAAAA,EAAE,WACA,IAAIC,EAAKC,mBAAmBF,EAAE,sBAAsBG,SAAW,GAC7DC,EAAMF,mBAAmBF,EAAE,uBAAuBG,SAAW,GAC7DE,EAAUH,mBAAmBF,EAAE,2BAA2BG,SAAW,GACrEG,EAAOJ,mBAAmBF,EAAE,wBAAwBG,SAAW,GAC/DI,EAAOP,EAAE,kBAAkBG,QAAU,IACrCK,EAAO,UAAYP,EAAK,YAAcI,EAAU,QAAUD,EAC1DK,EAAOD,EAAO,SAAWF,EACzBI,EACE,8DAEAT,EACA,QACAG,EACA,OACAC,EACFM,EACE,qCAEAV,EACA,YACAI,EACA,QACAD,EACFQ,EACE,yDAAyDC,KACvDC,UAAUC,aACN,YAAYF,KAAKC,UAAUC,WACnCC,GAAU,EACVC,GAAS,EACTC,EAAYlB,EAAE,yBAEhB,SAASmB,IACPD,EAAUE,QACLJ,GAOEC,EAOHC,EAAUG,OACRrB,EAAE,OAAOsB,KACP,qEARJJ,EAAUG,OACRrB,EAAE,OAAOsB,KACP,8DAWNJ,EAAUG,OAAO,CACfrB,EAAE,YAAYsB,KAAK,SAASC,MAAMC,EAAKd,IACvC,IACAV,EAAE,YAAYsB,KAAK,SAASC,MAAMC,EAAKb,IACvC,IACAX,EAAE,YAAYsB,KAAK,oBAAoBC,MAAMC,EAAKhB,OAzBhDI,EACFM,EAAUG,OAAO,CAACrB,EAAE,YAAYsB,KAAK,cAAcC,MAAMC,EAAKf,MAE9DS,EAAUG,OAAO,CAACrB,EAAE,YAAYsB,KAAK,SAASC,MAAME,KA0BxDP,EAAUG,OAAO,CACf,IACArB,EAAE,OAAOsB,KAAK,cAAcI,KAAK,OAAQ,KAAKH,MAAMI,KAGlDX,IAAYC,GAAQU,IAK1B,SAASH,EAAKI,GACZ,OAAO,SAAUC,GACfC,OAAON,KAAKI,GACZG,SAASC,KAAOzB,EAChBsB,EAAMI,kBAIV,SAASR,IACPT,GAAU,EACVkB,EAAOlC,EAAE,wBAAwB,IACjCiB,EAASkB,SAASC,YAAY,QAC9BjB,IAGF,SAASQ,IACP3B,EAAE,0BAA0BqC,OAG9B,SAASH,EAAO/B,GACd,IAAImC,EACAH,SAAS7B,KAAKiC,kBAChBD,EAAQH,SAAS7B,KAAKiC,mBAChBC,kBAAkBrC,GACxBmC,EAAMJ,UACGJ,OAAOW,gBAChBH,EAAQH,SAASO,eACXC,mBAAmBxC,IACzByC,EAAYd,OAAOW,gBACTI,kBACVD,EAAUE,SAASR,IAhCvBtC,EAAE,0BAA0B+C,OAoC5B/C,EAAE,yBAAyBuB,MAAM,SAAUyB,GACzCd,EAAOc,EAAEC,UAGX9B","sourceRoot":"/source/"}